# Name:    PyHouse-ansible/roles/networking/tasks/main.yaml
# Author:  D. Brian Kimmel
# Created: 2017-10-15
# Updated: 2017-10-31

---

#- name: Task-01 - include cannontrail.yaml
  #include_vars:    group_vars/pinkpoppy
  #include_vars:    group_vars/cannontrail.yaml

- name: Task-01 - Debug
  ignore_errors:    yes
  vars:
    msg: |
         AP:{{ access_points }}; .
         Hostname:{{ inventory_hostname }};
  debug:
    msg: "{{ msg.split('\n') }}"

- name: Task-02-Debian - Install the wpa_supplicant file
  template:
    src:        ./wifi.j2
    dest:       /etc/wpa_supplicant/wpa_supplicant.conf
    owner:      root
    group:      root
    mode:       0600
  when:         ansible_distribution == 'Debian'

# this will set up static addresses on all interfaces except 'lo'
# It is the correct method for debian Jessie, Stretch and beond.
# Earlier releases used a different mechanism.
- name: Task-03-Debian - Install dhcpcd.conf file with interface IP definitions.
  template:
    src:        ./dhcpcd_conf.j2
    dest:       /etc/dhcpcd.conf
    owner:      root
    group:      netdev
    mode:       0664
  when:         ansible_distribution == 'Debian'

### END DBK
